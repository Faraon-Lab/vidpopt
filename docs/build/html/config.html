<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API" href="api.html" /><link rel="prev" title="Usage" href="usage.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Configuration - Vipdopt 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Vipdopt 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Vipdopt 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/config.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h1>
<p>Vipdopt requires two files within a project in order to run an optimization: the <a class="reference internal" href="#configuration-file"><span class="std std-ref">configuration file</span></a> and the <a class="reference internal" href="#simulation-file"><span class="std std-ref">simulation file.</span></a></p>
<p>Currently the following file formats are supported:</p>
<ul class="simple">
<li><p>YAML</p></li>
<li><p>JSON</p></li>
</ul>
<section id="configuration-file">
<span id="id1"></span><h2>Configuration File<a class="headerlink" href="#configuration-file" title="Link to this heading">¶</a></h2>
<p>The configuration file contains basic information needed to setup the optimization.</p>
<p>If multiple configuration files are located in your project directory, you can specify which to use in the optimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>vipdopt<span class="w"> </span>optimize<span class="w"> </span>/path/to/project<span class="w"> </span>--config<span class="w"> </span>config_name.ext
</pre></div>
</div>
<p>If the specified config file is not found, the program will attempt to automatically locate a file using the glob pattern <code class="docutils literal notranslate"><span class="pre">project/dir/**/*config*.{yaml,yml,json}</span></code></p>
<p>Below is a list of all required parameters in the configuration file</p>
<section id="required-parameters">
<h3>Required Parameters<a class="headerlink" href="#required-parameters" title="Link to this heading">¶</a></h3>
<section id="optimizer-and-optimizer-settings">
<h4><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> and <code class="docutils literal notranslate"><span class="pre">optimizer_settings</span></code><a class="headerlink" href="#optimizer-and-optimizer-settings" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">optimizer</span></code>: The optimizer to use</p>
<p><code class="docutils literal notranslate"><span class="pre">optimizer_settings</span></code> is a dictionary specifying the settings to instantiate the optimizer with.</p>
<p>Currently supported optimizers are:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">AdamOptimizer</span></code>, which implements the <a class="reference external" href="https://arxiv.org/abs/1412.6980">adam algorithm</a></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">step_size</span></code> (float): The step size to use; defaults to 0.01</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">betas</span></code> (float, float): The betas to use; defaults to (0.9, 0.999)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eps</span></code> (float): The epsilon value to use; defaults to 1e-8</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">GradientDescentOptimizer</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">step_size</span></code> (float): The step size to use; defaults to 0.01</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="lumerical-environment-variables">
<h4>Lumerical Environment Variables<a class="headerlink" href="#lumerical-environment-variables" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mpi_exe</span></code>: The path to the installation of MPI to use</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">solver_exe</span></code>: The path to the FDTD solver to run the sumlations with</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nprocs</span></code>: The number of processeros to use for each simulation</p></li>
</ul>
<p>When running the simulations, the following script will be called by Lumerical:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="ch">#!/bin/sh</span>
<span class="linenos">2</span>MPI_EXE<span class="w"> </span>-n<span class="w"> </span>NPROCS<span class="w"> </span>SOLVER_EXE<span class="w"> </span><span class="o">{</span>PROJECT_FILE_PATH<span class="o">}</span>
<span class="linenos">3</span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</section>
<section id="figures-of-merit">
<h4><code class="docutils literal notranslate"><span class="pre">figures_of_merit</span></code><a class="headerlink" href="#figures-of-merit" title="Link to this heading">¶</a></h4>
<p>To describe the figures of merit (FoMs) to use in your optimization, a dictionary titled <code class="docutils literal notranslate"><span class="pre">figures_of_merit</span></code> is required containing a sub-dictionaries for each FoM, using the name of the FoM as the key. The overall FoM will be computed as the weighted sum of all the individual FoMs. The FoM sub-dictionaries contain the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: The type of FoM to use. Currently includes <code class="docutils literal notranslate"><span class="pre">BayerFilterFoM</span></code> and <code class="docutils literal notranslate"><span class="pre">UniformFoM</span></code></p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">fom_monitors</span></code>: A list of monitors in the simulation to connect to for computing the FoM</dt><dd><ul>
<li><p>Each monitor has the format <code class="docutils literal notranslate"><span class="pre">[source_name,</span> <span class="pre">monitor_name]</span></code>, with the appropriate values from the <a class="reference internal" href="#simulation-file"><span class="std std-ref">simulation</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">grad_monitors</span></code>: A list of monitors in the simulation to connect to for computing the gradient</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">polarization</span></code>: The polarization to use</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">freq</span></code>: A list of all frequencies in the optimization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opt_ids</span></code> (optional): A List of the indices of the frequencies to use in the calculations; defaults to all frequencies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> (optional): The weight to appply to this FoM; defaults to 1.0</p></li>
</ul>
</section>
<section id="miscellaneous-parameters">
<h4>Miscellaneous Parameters<a class="headerlink" href="#miscellaneous-parameters" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_bands</span></code>: The number of frequency bands</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_design_frequency_points</span></code>:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda_values_um</span></code>: The wavelengths of light to use in the optimization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simulator_dimension</span></code>: Whether the simulator is <code class="docutils literal notranslate"><span class="pre">2D</span></code> or <code class="docutils literal notranslate"><span class="pre">3D</span></code></p></li>
</ul>
</section>
</section>
<section id="optional-parameters">
<h3>Optional Parameters<a class="headerlink" href="#optional-parameters" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">current_epoch</span></code>: The current epoch to start the optimization from; defaults to 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">current_iteration</span></code>: The current iteration within an epoch to start from; defaults to 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_epochs</span></code>: The maximum number of epochs to run before ending the optimization; defaults to 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iter_per_epoch</span></code>: The number of iterations within an epoch; defaults to 100.</p></li>
</ul>
<p>You’re also welcome to include your own parameters.</p>
<p>The following are some parameters in [<cite>config_example.yaml</cite>](/vipdopt/configuration/config_example.yml) that are often adjusted, and their default values:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">mesh_spacing_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.017</span>
<span class="linenos"> 2</span><span class="nt">geometry_spacing_lateral_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.085</span>
<span class="linenos"> 3</span><span class="nt">device_scale_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.051</span><span class="w">    </span><span class="c1"># Controls vertical dimensions e.g. focal length, device vertical layer voxels, and FDTD gap sizes.</span>
<span class="linenos"> 4</span><span class="nt">num_vertical_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="linenos"> 5</span><span class="nt">vertical_layer_height_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.204</span>
<span class="linenos"> 6</span><span class="nt">device_size_lateral_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.04</span>
<span class="linenos"> 7</span><span class="nt">sidewall_thickness_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.24</span>
<span class="linenos"> 8</span><span class="nt">sidewall_material</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;air&#39;</span>
<span class="linenos"> 9</span><span class="nt">lambda_min_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.375</span>
<span class="linenos">10</span><span class="nt">lambda_max_um</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.725</span>
<span class="linenos">11</span><span class="nt">f_number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.2</span>
<span class="linenos">12</span><span class="nt">source_angle_theta_vacuum_deg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="linenos">13</span><span class="nt">source_angle_phi_deg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="linenos">14</span><span class="nt">num_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="linenos">15</span><span class="nt">num_iterations_per_epoch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="linenos">16</span><span class="nt">desired_peaks_per_band_um</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">0.48</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.52</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.59</span><span class="w"> </span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<section id="device">
<h4><code class="docutils literal notranslate"><span class="pre">device</span></code><a class="headerlink" href="#device" title="Link to this heading">¶</a></h4>
<p>While technically the <code class="docutils literal notranslate"><span class="pre">device</span></code> parameter is optional, not including one will result in using our default device.</p>
<p>If you’d like to provide your own device specification, you have two options:</p>
<ol class="arabic">
<li><p>Provide a path to a <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file saved with <code class="docutils literal notranslate"><span class="pre">vipdopt.optimization.device.Device.save</span></code>. This is mainly for loading existing projects.</p></li>
<li><dl>
<dt>Provide a dictionary with the following values:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> (int, int): The size (in voxels) of a device layer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permittivity_constraints</span></code> (float, float): The min/max permittivity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coords</span></code> (float, float, float): The coordinates in 3D space of the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (str): The name of the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_density</span></code> (float): The initial density of the device, when not randomized</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">randomize</span></code> (bool): Whether to randomize the initial device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init_seed</span></code> (int): The random seed to use when initializing the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">symmetric</span></code> (bool): Whther the initial device should be symmetric</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filters</span></code>: A List of filter objects to use with format</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">TYPE</span><span class="p">,</span>
    <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>The types of filters currently supported are</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Sigmoid</span></code>, which has an <code class="docutils literal notranslate"><span class="pre">eta</span></code> and <code class="docutils literal notranslate"><span class="pre">beta</span></code> parameter defininfg a sigmoid function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Scale</span></code>, which has <code class="docutils literal notranslate"><span class="pre">variable_bounds</span></code>, the min/max of scaled variables</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</li>
</ol>
</section>
</section>
</section>
<section id="simulation-file">
<span id="id2"></span><h2>Simulation File<a class="headerlink" href="#simulation-file" title="Link to this heading">¶</a></h2>
<p>The simulation file is a JSON file containing all of the objects to create in a Lumerical project. This serves as the “base simulation” from which the optimization gets it’s data.</p>
<p>The simulation consists of two sub-dictionaries: <code class="docutils literal notranslate"><span class="pre">info</span></code> and <code class="docutils literal notranslate"><span class="pre">objects</span></code>.</p>
<section id="info">
<h3><code class="docutils literal notranslate"><span class="pre">info</span></code><a class="headerlink" href="#info" title="Link to this heading">¶</a></h3>
<p>This contains general information about a simulation. The values are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name of the simulation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: The path to save this simulation to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simulator_name</span></code>: What simulator to use. Currently only supports <code class="docutils literal notranslate"><span class="pre">LumericalFDTD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coordinates</span></code>: A dictionary of …</p></li>
</ul>
</section>
<section id="objects">
<h3><code class="docutils literal notranslate"><span class="pre">objects</span></code><a class="headerlink" href="#objects" title="Link to this heading">¶</a></h3>
<p>The objects dictionary contains all of the simulation objects to create in the FDTD software.</p>
<p>Each object has the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">NAME</span><span class="p">,</span>
    <span class="s2">&quot;obj_type&quot;</span><span class="p">:</span> <span class="n">TYPE</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code> contains all of the properties one would set in Lumerical, e.g. <cite>x span</cite>, <cite>z min</cite>, <cite>override global monitor settings</cite>, etc.</p>
<p>The available types of objects are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fdtd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rect</span></code></p></li>
<li><dl class="simple">
<dt>Source objects:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dipole</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tfsf</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Monitor objects:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">profile</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Device objects:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mesh</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>It is possible to have multiple devices in your optimization. Therefore, all device objects (profile, index, import, and mesh) have an additional field <code class="docutils literal notranslate"><span class="pre">dev_id</span></code> which is the index of the device these values correspond to.</p>
</section>
</section>
<section id="generating-configuration-files-with-jinja2">
<h2>Generating Configuration Files with Jinja2<a class="headerlink" href="#generating-configuration-files-with-jinja2" title="Link to this heading">¶</a></h2>
<p>Maintaining all of these different properties inside the configuration and simulation files can be tedious. For that reason, we provide an easy way to generate these files using Jinja2.</p>
<p>For an intro to using Jinja2 templating, see <a class="reference external" href="https://ttl255.com/jinja2-tutorial-part-1-introduction-and-variable-substitution/">this guide.</a></p>
<p>We’ve provided a set of templates to use in the [<cite>jinja_templates</cite> directory](/jinja_templates/).</p>
<p>Once you have your template file created, and a data file (in YAMl or JSON format) to substitute values in, you can run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>vipdopt.configuration.template<span class="w"> </span>template_file_name.ext<span class="w"> </span>/path/to/data/file<span class="w"> </span>output_file_name.ext
</pre></div>
</div>
<p>Note that by default, this script will search for your template in <code class="docutils literal notranslate"><span class="pre">/jinja_templates/</span></code>. To overwrite this, use the <code class="docutils literal notranslate"><span class="pre">-s</span></code> command. For more details use <code class="docutils literal notranslate"><span class="pre">--help</span></code></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="usage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Usage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Nia McNichols
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#configuration-file">Configuration File</a><ul>
<li><a class="reference internal" href="#required-parameters">Required Parameters</a><ul>
<li><a class="reference internal" href="#optimizer-and-optimizer-settings"><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> and <code class="docutils literal notranslate"><span class="pre">optimizer_settings</span></code></a></li>
<li><a class="reference internal" href="#lumerical-environment-variables">Lumerical Environment Variables</a></li>
<li><a class="reference internal" href="#figures-of-merit"><code class="docutils literal notranslate"><span class="pre">figures_of_merit</span></code></a></li>
<li><a class="reference internal" href="#miscellaneous-parameters">Miscellaneous Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optional-parameters">Optional Parameters</a><ul>
<li><a class="reference internal" href="#device"><code class="docutils literal notranslate"><span class="pre">device</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#simulation-file">Simulation File</a><ul>
<li><a class="reference internal" href="#info"><code class="docutils literal notranslate"><span class="pre">info</span></code></a></li>
<li><a class="reference internal" href="#objects"><code class="docutils literal notranslate"><span class="pre">objects</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#generating-configuration-files-with-jinja2">Generating Configuration Files with Jinja2</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>